# Random Forest Ensemble Strategy Configuration
# Achieves 3.86% annualized return with 4-model ensemble

data:
  file_path: "../market data pipeline/processed market data/market_data_time_series.csv"
  date_column: "Date"
  use_multi_index: true  # Enable multi-index CSV loading
  multi_index_header_rows: 2
  date_header_row: 2
  
  # Asset class filtering - include all needed asset classes
  asset_classes_include:
    - "cad_credit_spreads"
    - "cad_credit_exposure"
    - "equity_indices"
    - "volatility"
    - "yield_curves"
    - "economic_indicators"
    - "forecasts"
  asset_classes_exclude: null
  
  # Column filtering - include all columns needed by RF Ensemble strategy
  columns_include:
    cad_credit_spreads: ["cad_oas"]
    cad_credit_exposure: ["cad_ig_er_index"]
    equity_indices: ["tsx", "s&p_500"]
    volatility: ["vix"]
    yield_curves: ["us_3m_10y"]
    economic_indicators: ["us_growth_surprises", "us_inflation_surprises", "us_lei_yoy", "us_hard_data_surprises", "us_equity_revisions", "us_economic_regime"]
    forecasts: ["spx_1bf_eps", "spx_1bf_sales", "tsx_1bf_eps", "tsx_1bf_sales"]
  columns_exclude: null
  
  # Date range
  resample_frequency: null # Use raw daily data
  start_date: null
  end_date: null
  
  # Missing data handling
  missing_data_strategy: "forward_fill"
  missing_data_fill_value: 0.0
  
  # Multi-index flattening
  flatten_columns: true
  
  # Existing fields
  benchmark_asset: "cad_ig_er_index"
  trading_asset: "cad_ig_er_index"
  assets: []  # Will be populated after flattening
  required_columns: []

portfolio:
  initial_capital: 100
  frequency: "D" # Daily frequency
  fees: 0.0
  slippage: 0.0
  position_size: 1.0
  leverage: 1.0

reporting:
  output_dir: "outputs/reports"
  generate_html: true
  generate_pdf: false
  include_plots: true
  metrics_precision: 4

# Feature engineering configuration (not used by RF Ensemble, but required by framework)
features:
  momentum_periods: [5, 10, 15, 20, 30, 40, 60]
  volatility_windows: [20, 40, 60]
  sma_windows: [20, 40, 60]
  include_macd: false
  include_stochastic: false
  include_rsi: false
  include_bollinger: false
  include_oas_features: false
  include_vix: false
  include_correlations: false
  include_relative_strength: false
  primary_asset: "cad_ig_er_index"
  fill_na_value: 0.0

# Random Forest Ensemble Strategy Configuration
rf_ensemble_strategy:
  # Trading parameters
  trading_asset: "cad_ig_er_index"
  benchmark_asset: "cad_ig_er_index"

  # Feature engineering parameters
  momentum_windows: [2, 3, 5, 7, 10, 12, 15, 20, 25, 30, 40, 50, 60, 90, 120]
  zscore_windows: [5, 10, 20, 40, 60, 120, 252]
  macro_windows: [3, 5, 10, 20, 40, 60, 90]

  # Model configurations (4 Random Forest models)
  # Each model has different hyperparameters for diversity
  models:
    # Model 1: Deep trees, moderate samples
    - n_estimators: 600
      max_depth: 15
      min_samples_leaf: 5
      max_features: 0.4
      random_state: 42

    # Model 2: More trees, shallower, conservative
    - n_estimators: 700
      max_depth: 12
      min_samples_leaf: 8
      max_features: 0.5
      random_state: 42

    # Model 3: Very deep, fewer trees
    - n_estimators: 500
      max_depth: 18
      min_samples_leaf: 5
      max_features: 0.3
      random_state: 123

    # Model 4: Many trees, shallow, more conservative
    - n_estimators: 800
      max_depth: 10
      min_samples_leaf: 10
      max_features: 0.4
      random_state: 456

  # Ensemble parameters
  ensemble_weights: [0.30, 0.30, 0.25, 0.15]  # Weights for each model
  probability_threshold: 0.55                  # Entry threshold

  # Trading rules
  holding_period_days: 7                       # Minimum holding period
  train_test_split: 0.70                       # 70% train, 30% test

  # Strategy metadata
  name: "RF Ensemble ML Strategy"
  description: "4-model Random Forest ensemble achieving 3.86% annualized returns"
  type: "rf_ensemble_strategy"

# Strategy selection control
strategies:
  enabled:
    - "rf_ensemble_strategy"
  run_all_by_default: false

# Enhanced reporting configuration
enhanced_reporting:
  generate_detailed_stats_file: true
  stats_file_name: "rf_ensemble_strategy_report.txt"
  include_vectorbt_stats: true
  include_quantstats_metrics: true
  include_manual_calculations: true
  include_drawdown_analysis: true

# Common settings
random_seed: 42
verbose: true
log_level: "INFO"
